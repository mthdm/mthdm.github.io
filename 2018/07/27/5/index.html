<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="John Doe"><title>Pi编译安装PHPNginx并安装完整LEMP环境 · Hexo</title><meta name="description" content="1.安装 Nginx+Php+Mysql
#添加Nginx、Php最新源并刷新源
sudo add-apt-repository ppa:nginx&amp;#x2F;stable
sudo add-apt-repository ppa:ondrej&amp;#x2F;php
sudo apt-get update"><meta name="keywords" content=""><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/bootstrap.min.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/style.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><div id="stage" class="container"><div class="row"><div id="side-bar" class="col-sm-3 col-xs-12 side-container invisible"><div class="vertical-text site-title"><h3 tabindex="-1" class="site-title-small"><a href="/" class="a-title">Typography</a></h3><h1 tabindex="-1" class="site-title-large"><a href="/" class="a-title">活版印字</a></h1><!--h6(onclick="triggerSiteNav()") Trigger--></div><br class="visible-lg visible-md visible-sm"><div id="site-nav" class="site-title-links"><ul><li><a href="/">Home</a></li><li><a href="/archives">Archive</a></li><li><a href="/categories">Categories</a></li><li><a href="/tags">Tags</a></li><li class="soc"><a href="http://yoursite.com/atom.xml" target="_blank" rel="noopener noreferrer"><i class="fa fa-rss">&nbsp;</i></a></li></ul><div class="visible-lg visible-md visible-sm site-nav-footer"><br class="site-nav-footer-br"><footer><p>&copy;&nbsp;2020&nbsp;<a target="_blank" href="http://yoursite.com" rel="noopener noreferrer">John Doe</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div><div id="main-container" class="col-sm-9 col-xs-12 main-container invisible"><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post-container"><p class="post-title"><a>Pi编译安装PHPNginx并安装完整LEMP环境</a></p><p class="post-meta"><span class="date meta-item">Posted at&nbsp;2018-07-27</span><span class="meta-item"><i class="fa fa-folder"></i><span>&nbsp;</span><a href="/categories/技术文档/" title="技术文档" class="a-tag">技术文档</a><span>&nbsp;</span><a href="/categories/技术文档/树莓派-香橙派/" title="树莓派&amp;香橙派" class="a-tag">树莓派&amp;香橙派</a><span>&nbsp;</span></span><span class="meta-item"><i class="fa fa-tag"></i><span>&nbsp;</span><a href="/tags/技术文档/" title="技术文档" class="a-tag">技术文档</a><span>&nbsp;</span><a href="/tags/树莓派-香橙派/" title="树莓派&amp;香橙派" class="a-tag">树莓派&amp;香橙派</a><span>&nbsp;</span></span></p><p class="post-abstract"><p>　　1.安装 Nginx+Php+Mysql</p>
<pre><code>#添加Nginx、Php最新源并刷新源
sudo add-apt-repository ppa:nginx&#x2F;stable
sudo add-apt-repository ppa:ondrej&#x2F;php
sudo apt-get update

#安装Nginx
sudo apt-get install nginx

#安装Php7.1 FPM
sudo apt-get install php7.1-fpm
#php7.1 curl扩展
sudo apt-get install php7.1-curl

#安装Mysql
sudo install mysql-server
#备份Mysql数据库
mysqldump -u root -p 欲备份的数据库名 &gt; 导出的数据库名.sql
#恢复mysql数据库
mysql -u root -p 恢复的数据库名 &lt; 导出过的数据库名.sql
＃如恢复的数据库不存在 需要手动创建
create database 恢复的数据库名;</code></pre>
<p>2.编译安装Nginx/1.11.4升级HTTP/2.0</p>
<pre><code>#下载并解压Nginx源码
wget -c https:&#x2F;&#x2F;nginx.org&#x2F;download&#x2F;nginx-1.11.4.tar.gz
tar -zxvf nginx-1.11.4.tar.gz

#下载并解压OpenSSL源码
wget -c https:&#x2F;&#x2F;www.openssl.org&#x2F;source&#x2F;openssl-1.1.0.tar.gz
tar -zxvf openssl-1.1.0.tar.gz

#下载并解压nginx-ct源码
wget -O nginx-ct.zip -c https:&#x2F;&#x2F;github.com&#x2F;grahamedgecombe&#x2F;nginx-ct&#x2F;archive&#x2F;v1.3.0.zip
unzip nginx-ct.zip

#修复Nginx&#x2F;1.11.3无法编译的问题&lt;font style&#x3D;&quot;color:red&quot;&gt;此问题在Nginx 1.11.4已经解决,1.11.4请忽略&lt;&#x2F;font&gt;
#由于OpenSSL 1.1.0 删除了 SSL_R_NO_CIPHERS_PASSED导致Nginx无法编译。这里我们需要修复nginx源码中的[一个文件](https:&#x2F;&#x2F;github.com&#x2F;nginx&#x2F;nginx&#x2F;commit&#x2F;af9e72533a69de3b8b7ed59be7be9b37203b5c82)

#用文本编辑器打开 .&#x2F;nginx-1.11.3&#x2F;src&#x2F;event&#x2F;ngx_event_openssl.c
#找到这个位置,大约在第2000行附近
if (n &#x3D;&#x3D; SSL_R_BAD_CHANGE_CIPHER_SPEC                        &#x2F;*  103 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_BLOCK_CIPHER_PAD_IS_WRONG                  &#x2F;*  129 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_DIGEST_CHECK_FAILED                        &#x2F;*  149 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_ERROR_IN_RECEIVED_CIPHER_LIST              &#x2F;*  151 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_EXCESSIVE_MESSAGE_SIZE                     &#x2F;*  152 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_LENGTH_MISMATCH                            &#x2F;*  159 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_NO_CIPHERS_PASSED                          &#x2F;*  182 *&#x2F;
         
修改为

if (n &#x3D;&#x3D; SSL_R_BAD_CHANGE_CIPHER_SPEC                        &#x2F;*  103 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_BLOCK_CIPHER_PAD_IS_WRONG                  &#x2F;*  129 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_DIGEST_CHECK_FAILED                        &#x2F;*  149 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_ERROR_IN_RECEIVED_CIPHER_LIST              &#x2F;*  151 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_EXCESSIVE_MESSAGE_SIZE                     &#x2F;*  152 *&#x2F;
         || n &#x3D;&#x3D; SSL_R_LENGTH_MISMATCH                            &#x2F;*  159 *&#x2F;
#ifdef SSL_R_NO_CIPHERS_PASSED
         || n &#x3D;&#x3D; SSL_R_NO_CIPHERS_PASSED                          &#x2F;*  182 *&#x2F;
#endif

#保存


#编译Nginx

#进入Nginx源码目录
cd .&#x2F;nginx-1.11.4

#生成编译配置
.&#x2F;configure \
#设置OpenSSL源码目录
--with-openssl&#x3D;..&#x2F;openssl-1.1.0 \
#设置nginx-ct源码目录
--add-module&#x3D;..&#x2F;nginx-ct-1.3.0 \
--with-debug \
--with-pcre-jit \
--with-ipv6 \
--with-http_ssl_module \
#启用HTTP&#x2F;2.0模块
--with-http_v2_module \
--with-http_stub_status_module \
--with-http_realip_module \
--with-http_auth_request_module \
--with-http_addition_module \
--with-http_dav_module \
--with-http_gzip_static_module \
--with-http_sub_module \
--with-mail \
--with-mail_ssl_module
#如无缺失依赖库,将会生成MakeFile

#开始编译
make
#编译完成后安装
sudo make install
#默认安装在 &#x2F;usr&#x2F;local&#x2F;nginx 下

#install Nginx End.</code></pre>
<p>3.编译安装Php7.0</p>
<pre><code>#从http:&#x2F;&#x2F;php.net&#x2F;get&#x2F;php-7.0.8.tar.gz&#x2F;from&#x2F;a&#x2F;mirror 下载源码并解压
tar -xzvf xxxx.tar.gz 

#安装依赖
apt-get install libxml2-dev  libssl-dev libcurl4-gnutls-dev libmcrypt-dev

#解压镜像，然后进入文件夹中
.&#x2F;configure --prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;php7 \
--exec-prefix&#x3D;&#x2F;usr&#x2F;local&#x2F;php7 \
--bindir&#x3D;&#x2F;usr&#x2F;local&#x2F;php7&#x2F;bin \
--sbindir&#x3D;&#x2F;usr&#x2F;local&#x2F;php7&#x2F;sbin \
--includedir&#x3D;&#x2F;usr&#x2F;local&#x2F;php7&#x2F;include \
--libdir&#x3D;&#x2F;usr&#x2F;local&#x2F;php7&#x2F;lib&#x2F;php \
--mandir&#x3D;&#x2F;usr&#x2F;local&#x2F;php7&#x2F;php&#x2F;man \
--enable-mbstring \
--with-curl \
--with-gd \
--with-config-file-path&#x3D;&#x2F;usr&#x2F;local&#x2F;php7&#x2F;etc \
--enable-fpm \
--enable-mysqlnd \
--with-pdo-mysql&#x3D;mysqlnd \
--with-mysql-sock&#x3D;&#x2F;var&#x2F;run&#x2F;mysqld&#x2F;mysqld.sock

#如提示缺少依赖包,请根据错误提示安装

#开始编译
make
#编译测试
make test
#安装
make install

#install Php7 End.</code></pre>
<p>　　转自周海棠啦 原文链接<a href="https://nayoo.top/2018/03/17/Pi-install-PHP-Nginx/" target="_blank" rel="noopener">https://nayoo.top/2018/03/17/Pi-install-PHP-Nginx/</a></p>
<hr>
</p></div><div class="share"><span>Share</span>&nbsp;<span class="soc"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></span><span class="soc"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></span><span class="soc"><a href="http://twitter.com/home?status=http://yoursite.com/2018/07/27/5/%20Hexo%20Pi编译安装PHPNginx并安装完整LEMP环境" target="_blank" rel="noopener" class="fa fa-twitter"></a></span></div><div class="pagination"><p class="clearfix"><span class="pre pagbuttons"><a role="navigation" href="/2018/08/15/6/" title="树莓派使用xrdp连接远程桌面"><i class="fa fa-angle-double-left"></i>&nbsp;Previous post: 树莓派使用xrdp连接远程桌面</a></span><span>&nbsp;</span><span class="next pagbuttons"><a role="navigation" href="/2018/06/27/4/" title="沙恩的终结：只要还有最后一发炮弹 都将坚持战斗">Next post: 沙恩的终结：只要还有最后一发炮弹 都将坚持战斗&nbsp;<i class="fa fa-angle-double-right"></i></a></span></p></div></div></div></div><div class="visible-xs site-bottom-footer"><footer><p>&copy;&nbsp;2020&nbsp;<a target="_blank" href="http://yoursite.com" rel="noopener noreferrer">John Doe</a></p><p>Theme&nbsp;<a target="_blank" href="https://github.com/SumiMakito/hexo-theme-typography" rel="noopener noreferrer">Typography</a>&nbsp;by&nbsp;<a target="_blank" href="https://www.keep.moe" rel="noopener noreferrer">Makito</a></p><p>Proudly published with&nbsp;<a target="_blank" href="https://hexo.io" rel="noopener noreferrer">Hexo</a></p></footer></div></div></div></div><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/google-analytics.js"></script><script src="/js/typography.js"></script></body></html>